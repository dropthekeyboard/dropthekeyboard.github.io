# ReasoningAgentSection ë¦¬íŒ©í† ë§ ê³„íš

## ì‘ì—…ì˜ ëª©ì 

ê¸°ì¡´ `TerminalSection`ì„ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” `ReasoningAgentSection` ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬í˜„í•˜ì—¬, AI Agentì˜ **ì¶”ë¡  ê³¼ì •ì„ ê°•ì¡°**í•˜ê³  **Actionì€ ê°„ì†Œí™”**í•œ ìƒˆë¡œìš´ ì‹œê°í™” ë°©ì‹ì„ ì œê³µí•œë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ìëŠ” AI Agentê°€ **ì™œ ê·¸ëŸ° í–‰ë™ì„ ì„ íƒí–ˆëŠ”ì§€**ì— ëŒ€í•œ ì˜ì‚¬ê²°ì • ê³¼ì •ì„ ëª…í™•í•˜ê²Œ ì´í•´í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

## í˜„ì¬ì˜ ìƒíƒœ / ë¬¸ì œì 

### 1. TerminalSectionì˜ í˜„ì¬ êµ¬ì¡°

- **ë°ì´í„° íë¦„**: `scenario.tsx`ì˜ `AgenticStep[]`ì„ í•„í„°ë§í•˜ì—¬ íŠ¹ì • Agentì˜ ì•¡ì…˜ë§Œ í‘œì‹œ
- **ì‹œê°í™” ë°©ì‹**: í„°ë¯¸ë„ ìŠ¤íƒ€ì¼ë¡œ ì•¡ì…˜ì˜ **êµ¬ì²´ì  ë‚´ìš©**ì— ì§‘ì¤‘ (ë©”ì‹œì§€ ë‚´ìš©, API í˜¸ì¶œ ìƒì„¸ ë“±)
- **Props ì¸í„°í˜ì´ìŠ¤**: `entity`, `label`, `labelColor`, `sectionClass`, `steps?`, `entityName?`, `isActive?`, `variant?`
- **í•µì‹¬ ë¡œì§**: `LogicCard` ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ ê° `AgenticStep`ì„ ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œ

### 2. ê¸°ì¡´ ë°ì´í„° êµ¬ì¡°ì˜ í•œê³„

- `AgenticStep`ì˜ `reason` í•„ë“œê°€ AIì˜ ì¶”ë¡  ê³¼ì •ì„ ë‹´ê³  ìˆì§€ë§Œ ì‹œê°ì ìœ¼ë¡œ ê°•ì¡°ë˜ì§€ ì•ŠìŒ
- ì•¡ì…˜ì˜ êµ¬ì²´ì  ë‚´ìš©(`content`, `request`, `response` ë“±)ì´ ì£¼ìš” ì •ë³´ë¡œ í‘œì‹œë˜ì–´ ì¶”ë¡  ê³¼ì •ì´ ë¶€ì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë¨
- ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ìŠ¤íƒ€ì¼ì˜ **ì…ë ¥â†’ì¶”ë¡ â†’ì¶œë ¥** íë¦„ì´ ëª…í™•í•˜ì§€ ì•ŠìŒ

### 3. ì‹œë‚˜ë¦¬ì˜¤ ë°ì´í„° êµ¬ì¡° ë¶„ì„

```typescript
// scenarios.jsonì—ì„œ reason í•„ë“œ ì‚¬ìš© í˜„í™©
{
  "type": "send-message",
  "action": {
    "reason": "ê³ ê°ì˜ ì˜ˆì•½ ìš”ì²­ì— ë”°ë¼, í”„ë¡œí•„ê³¼ ê³¼ê±° ì„ í˜¸ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ..."
  }
}
```

- `reason` í•„ë“œì— AIì˜ ì¶”ë¡  ê³¼ì •ì´ ìì—°ì–´ë¡œ ê¸°ë¡ë˜ì–´ ìˆìŒ
- í•˜ì§€ë§Œ êµ¬ì¡°í™”ë˜ì§€ ì•Šì•„ **ìƒí™© ë¶„ì„**, **ì „ëµ ìˆ˜ë¦½**, **í–‰ë™ ê²°ì •** ë“±ì˜ ë‹¨ê³„ë³„ ë¶„ë¦¬ê°€ ì–´ë ¤ì›€

## ì¶”ê°€ ë¶„ì„ ê³¼ì œ

1. **ì¶”ë¡  ê³¼ì • êµ¬ì¡°í™” ë°©ë²•ë¡  ê²€í† **
   - í˜„ì¬ `reason` í•„ë“œì˜ ìì—°ì–´ í…ìŠ¤íŠ¸ë¥¼ ì–´ë–»ê²Œ **êµ¬ì¡°í™”ëœ ì¶”ë¡  ë‹¨ê³„**ë¡œ ë³€í™˜í•  ê²ƒì¸ê°€?
   - ì…ë ¥ ì •ë³´, ìƒí™© ë¶„ì„, ì „ëµ ìˆ˜ë¦½, í–‰ë™ ê²°ì •ì˜ 4ë‹¨ê³„ êµ¬ì¡°ê°€ ì ì ˆí•œê°€?

2. **ê¸°ì¡´ ì‹œë‚˜ë¦¬ì˜¤ ë°ì´í„°ì™€ì˜ í˜¸í™˜ì„±**
   - ìƒˆë¡œìš´ ì¶”ë¡  ì¤‘ì‹¬ ë°ì´í„° êµ¬ì¡°ë¥¼ ë„ì…í•˜ë©´ì„œë„ ê¸°ì¡´ `scenarios.json` ë°ì´í„°ë¥¼ í™œìš©í•  ìˆ˜ ìˆëŠ” ë³€í™˜ ë¡œì§ì´ í•„ìš”
   - ì–´ë–¤ `AgenticStep` íƒ€ì…ë“¤ì„ ì–´ë–»ê²Œ ì…ë ¥/ì¶”ë¡ /ì¶œë ¥ìœ¼ë¡œ ë¶„ë¥˜í•  ê²ƒì¸ê°€?

3. **TerminalSectionê³¼ì˜ Swap ë©”ì»¤ë‹ˆì¦˜**
   - ë™ì¼í•œ Props ì¸í„°í˜ì´ìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì–´ë–»ê²Œ ë‹¤ë¥¸ ì‹œê°í™”ë¥¼ ì œê³µí•  ê²ƒì¸ê°€?
   - `variant` propì„ í™œìš©í•˜ì—¬ `reasoning` ëª¨ë“œë¥¼ ì¶”ê°€í•  ê²ƒì¸ê°€, ì•„ë‹ˆë©´ ë³„ë„ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬í•  ê²ƒì¸ê°€?

## ë³€ê²½ ì´í›„ì˜ ìƒíƒœ / í•´ê²° íŒì • ê¸°ì¤€

### 1. ê¸°ëŠ¥ì  ëª©í‘œ

- [âœ…] `TerminalSection`ê³¼ ë™ì¼í•œ Props ì¸í„°í˜ì´ìŠ¤ë¡œ **ì™„ì „íˆ êµì²´ ê°€ëŠ¥**
- [âœ…] ê¸°ì¡´ `AgenticStep[]` ë°ì´í„°ë¥¼ ì…ë ¥ë°›ì•„ **ì¶”ë¡  ì¤‘ì‹¬** ì‹œê°í™” ì œê³µ
- [âœ…] shadcn/ui ë””ìì¸ ì‹œìŠ¤í…œì— ë§ëŠ” **ë¯¸ë‹ˆë©€í•˜ê³  ì„¸ë ¨ëœ** UI êµ¬í˜„
- [âœ…] **ì…ë ¥â†’ì¶”ë¡ â†’ì¶œë ¥** ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ìŠ¤íƒ€ì¼ í”Œë¡œìš° í‘œì‹œ

### 2. ì‹œê°ì  ëª©í‘œ

- [âœ…] ì¶”ë¡  ë‚´ìš©ì´ **70% ì´ìƒì˜ ì‹œê°ì  ë¹„ì¤‘**ì„ ì°¨ì§€
- [âœ…] Action ìœ í˜•ì€ **ì•„ì´ì½˜+ë¼ë²¨** í˜•íƒœë¡œ ê°„ì†Œí™” (êµ¬ì²´ì  ë‚´ìš© ì œê±°)
- [âœ…] **í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜**ìœ¼ë¡œ í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì¶”ë¡  ë‹¨ê³„ ê°•ì¡°
- [âœ…] **ì—°ê²°ì„ ê³¼ ë§ˆì»¤**ë¡œ ì‹œê°„ íë¦„ê³¼ ì¸ê³¼ê´€ê³„ ëª…í™•í™”

### 3. ì„±ëŠ¥ ëª©í‘œ

- [âœ…] ê¸°ì¡´ `TerminalSection`ê³¼ ë™ì¼í•œ **ë Œë”ë§ ì„±ëŠ¥** ìœ ì§€
- [âœ…] **ì‹¤ì‹œê°„ ìŠ¤í¬ë¡¤** ë° **ì• ë‹ˆë©”ì´ì…˜** ê¸°ëŠ¥ ì§€ì›
- [âœ…] **íƒ€ì… ì•ˆì „ì„±** ë³´ì¥

## ìˆ˜ì •ì´ í•„ìš”í•œ ì½”ë“œ ë° ìˆ˜ì •ë¶€ë¶„ì˜ ì½”ë“œ ìŠ¤ë‹ˆí•

### 1. ìƒˆë¡œìš´ íƒ€ì… ì •ì˜ íŒŒì¼ ìƒì„±

**íŒŒì¼**: `src/types/reasoning.ts`

```typescript
// ì¶”ë¡  ë‹¨ê³„ íƒ€ì… ì •ì˜
export type ReasoningStepType = 'input' | 'reasoning' | 'output';

// êµ¬ì¡°í™”ëœ ì¶”ë¡  ë‚´ìš©
export interface ReasoningContent {
  situation?: string; // í˜„ì¬ ìƒí™© ë¶„ì„
  requiredInfo?: string[]; // í•„ìš”í•œ ì •ë³´
  strategy?: string; // ìµœì  ì „ëµ
  evaluation?: string[]; // í‰ê°€ ê¸°ì¤€
  decision?: string; // ìµœì¢… ê²°ì •
}

// ì¶”ë¡  ì¤‘ì‹¬ ìŠ¤í… ì¸í„°í˜ì´ìŠ¤
export interface ReasoningStep {
  id: string;
  type: ReasoningStepType;
  timestamp: number;

  // ì…ë ¥/ì¶œë ¥ ë‹¨ê³„ìš©
  actionType?: string; // 'SMS', 'Call', 'API', 'Response' ë“±
  actionIcon?: string; // ì´ëª¨ì§€ ì•„ì´ì½˜

  // ì¶”ë¡  ë‹¨ê³„ìš©
  title?: string; // ì¶”ë¡  ë‹¨ê³„ ì œëª©
  reasoning?: ReasoningContent; // êµ¬ì¡°í™”ëœ ì¶”ë¡  ë‚´ìš©

  // ì›ë³¸ ë°ì´í„° ì°¸ì¡°
  originalStep?: AgenticStep;
}
```

### 2. ë°ì´í„° ë³€í™˜ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

**íŒŒì¼**: `src/utils/reasoningTransform.ts`

```typescript
import type { AgenticStep } from '@/contexts/scenario';
import type { ReasoningStep, ReasoningStepType } from '@/types/reasoning';

// AgenticStepì„ ReasoningStepìœ¼ë¡œ ë³€í™˜
export function transformToReasoningSteps(
  steps: AgenticStep[]
): ReasoningStep[] {
  const reasoningSteps: ReasoningStep[] = [];

  steps.forEach((step, index) => {
    // 1. ì…ë ¥ ë‹¨ê³„ ìƒì„± (fromì´ Agentê°€ ì•„ë‹Œ ê²½ìš°)
    if (step.action.from !== 'customer_agent') {
      reasoningSteps.push({
        id: `input-${step.action.timestamp}`,
        type: 'input',
        timestamp: step.action.timestamp,
        actionType: getActionType(step),
        actionIcon: getActionIcon(step),
        originalStep: step,
      });
    }

    // 2. ì¶”ë¡  ë‹¨ê³„ ìƒì„± (reasonì´ ìˆëŠ” ê²½ìš°)
    if (step.action.reason) {
      reasoningSteps.push({
        id: `reasoning-${step.action.timestamp}`,
        type: 'reasoning',
        timestamp: step.action.timestamp + 1,
        title: generateReasoningTitle(step),
        reasoning: parseReasoningContent(step.action.reason),
        originalStep: step,
      });
    }

    // 3. ì¶œë ¥ ë‹¨ê³„ ìƒì„± (Agentê°€ ìˆ˜í–‰í•˜ëŠ” ì•¡ì…˜)
    if (step.action.from === 'customer_agent') {
      reasoningSteps.push({
        id: `output-${step.action.timestamp}`,
        type: 'output',
        timestamp: step.action.timestamp + 2,
        actionType: getActionType(step),
        actionIcon: getActionIcon(step),
        originalStep: step,
      });
    }
  });

  return reasoningSteps.sort((a, b) => a.timestamp - b.timestamp);
}
```

### 3. ReasoningAgentSection ì»´í¬ë„ŒíŠ¸

**íŒŒì¼**: `src/components/shared/ReasoningAgentSection/index.tsx`

```typescript
interface ReasoningAgentSectionProps {
  entity: ServerState | null;
  label: string;
  labelColor: string;
  sectionClass: string;
  steps?: AgenticStep[];
  entityName?: string;
  isActive?: boolean;
  variant?: 'minimal' | 'formal' | 'hacker' | 'reasoning';
}

export function ReasoningAgentSection({
  entity,
  label,
  labelColor,
  sectionClass,
  steps: externalSteps,
  entityName,
  isActive: externalIsActive = false,
  variant = 'reasoning',
}: ReasoningAgentSectionProps) {
  // TerminalSectionê³¼ ë™ì¼í•œ ë°ì´í„° ë¡œì§
  const { state: scenarioState } = useScenario();
  const state = useMemo(
    () => (externalSteps ? { steps: externalSteps } : scenarioState),
    [externalSteps, scenarioState]
  );

  // AgenticStepì„ ReasoningStepìœ¼ë¡œ ë³€í™˜
  const reasoningSteps = useMemo(() => {
    const agentSteps = state.steps.filter(
      (s: AgenticStep) =>
        s.action.from === (entityName || entity?.name) ||
        s.action.to === (entityName || entity?.name)
    );
    return transformToReasoningSteps(agentSteps);
  }, [state.steps, entity, entityName]);

  return (
    <motion.div className={cn(sectionClass, 'reasoning-container')}>
      {/* Header - shadcn/ui ìŠ¤íƒ€ì¼ */}
      <div className="agent-header">
        <div className="agent-icon">ğŸ¤–</div>
        <div>
          <h3 className="agent-title">{label}</h3>
          <p className="agent-subtitle">Decision Process Visualization</p>
        </div>
      </div>

      {/* Reasoning Flow */}
      <div className="reasoning-flow">
        <AnimatePresence>
          {reasoningSteps.map((step, index) => (
            <ReasoningStepComponent
              key={step.id}
              step={step}
              isActive={isActive && index === reasoningSteps.length - 1}
            />
          ))}
        </AnimatePresence>
      </div>
    </motion.div>
  );
}
```

## ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì—°ê´€ ì½”ë“œ

### 1. ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©

- **LogicCard**: ì¶”ë¡  ë‚´ìš© í‘œì‹œë¥¼ ìœ„í•œ ì¹´ë“œ UI ì»´í¬ë„ŒíŠ¸ (`src/components/shared/LogicCard`)
- **SectionLabel**: ì„¹ì…˜ í—¤ë” ë¼ë²¨ ì»´í¬ë„ŒíŠ¸ (`src/components/shared/SectionLabel`)
- **ì• ë‹ˆë©”ì´ì…˜ ë¡œì§**: `TerminalSection`ì˜ ìŠ¤í¬ë¡¤ ë° í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ë¡œì§ ì¬ì‚¬ìš©

### 2. Hooks ì¬ì‚¬ìš©

- **useScenario**: ì‹œë‚˜ë¦¬ì˜¤ ìƒíƒœ ê´€ë¦¬ (`src/hooks/useScenario.ts`)
- **ìŠ¤í¬ë¡¤ ê´€ë¦¬**: `TerminalSection`ì˜ auto-scroll ë¡œì§ í™œìš©

### 3. ìŠ¤íƒ€ì¼ë§ ì‹œìŠ¤í…œ

- **TailwindCSS**: shadcn/ui ë””ìì¸ í† í° í™œìš©
- **framer-motion**: ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ íŒ¨í„´ ì¬ì‚¬ìš©
- **CSS ë³€ìˆ˜**: `src/index.css`ì˜ ìƒ‰ìƒ ì‹œìŠ¤í…œ í™œìš©

## Test Code ì¶”ê°€ ë° ìˆ˜ì • í•„ìš” ë¶€ë¶„ì— ëŒ€í•œ ê°€ì´ë“œ

### 1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

```typescript
// src/utils/__tests__/reasoningTransform.test.ts
describe('reasoningTransform', () => {
  test('AgenticStepì„ ReasoningStepìœ¼ë¡œ ì˜¬ë°”ë¥´ê²Œ ë³€í™˜', () => {
    // reasonì´ ìˆëŠ” stepì˜ ê²½ìš° input-reasoning-output ìˆœì„œë¡œ ë³€í™˜ë˜ëŠ”ì§€ í™•ì¸
  });

  test('Action íƒ€ì…ë³„ ì•„ì´ì½˜ ë§¤í•‘ ê²€ì¦', () => {
    // send-message â†’ SMS, make-call â†’ Call ë“± ë§¤í•‘ í™•ì¸
  });
});
```

### 2. ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸

```typescript
// src/components/shared/ReasoningAgentSection/__tests__/index.test.tsx
describe('ReasoningAgentSection', () => {
  test('TerminalSectionê³¼ ë™ì¼í•œ Propsë¡œ ë Œë”ë§', () => {
    // ê¸°ì¡´ TerminalSection Propsë¡œ ì •ìƒ ë Œë”ë§ë˜ëŠ”ì§€ í™•ì¸
  });

  test('ì¶”ë¡  ë‹¨ê³„ë³„ ì‹œê°ì  êµ¬ë¶„ í™•ì¸', () => {
    // input/reasoning/output ë‹¨ê³„ê°€ ì˜¬ë°”ë¥¸ ìŠ¤íƒ€ì¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
  });
});
```

### 3. í†µí•© í…ŒìŠ¤íŠ¸

```typescript
// src/components/DemoView/__tests__/reasoning-integration.test.tsx
describe('ReasoningAgentSection Integration', () => {
  test('AgentSectionì—ì„œ TerminalSection ëŒ€ì‹  ì‚¬ìš© ê°€ëŠ¥', () => {
    // AgentSectionì—ì„œ variant="reasoning" ì‹œ ì •ìƒ ì‘ë™ í™•ì¸
  });
});
```

---

**ì‘ì—… ìš°ì„ ìˆœìœ„:**

1. íƒ€ì… ì •ì˜ ë° ë³€í™˜ ë¡œì§ êµ¬í˜„ (ë†’ìŒ)
2. ê¸°ë³¸ ReasoningAgentSection ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (ë†’ìŒ)
3. shadcn/ui ìŠ¤íƒ€ì¼ë§ ì ìš© (ì¤‘ê°„)
4. ì• ë‹ˆë©”ì´ì…˜ ë° ì¸í„°ë™ì…˜ êµ¬í˜„ (ì¤‘ê°„)
5. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± (ë‚®ìŒ)

**ì˜ˆìƒ ì‘ì—… ê¸°ê°„:** 2-3ì¼
